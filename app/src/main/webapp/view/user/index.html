
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>用户中心</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="../../res/layui/css/layui.css">
  <link rel="stylesheet" href="../../res/css/global.css">
  <script type="text/javascript" src="../../res/layui/jquery.min.js" charset="utf-8"></script>
  <script type="text/javascript" src="../../res/js/baseUtils.js" charset="utf-8"></script>
</head>
<body>

<div id="header"></div>

<div class="layui-container fly-marginTop fly-user-main">
  <ul class="layui-nav layui-nav-tree layui-inline" lay-filter="user">
    <li class="layui-nav-item layui-this">
      <a href="index.html">
        <i class="layui-icon">&#xe612;</i>
        用户中心
      </a>
    </li>
    <li class="layui-nav-item">
      <a href="set.html">
        <i class="layui-icon">&#xe620;</i>
        基本设置
      </a>
    </li>
  </ul>

  <div class="site-tree-mobile layui-hide">
    <i class="layui-icon">&#xe602;</i>
  </div>
  <div class="site-mobile-shade"></div>
  
  <div class="site-tree-mobile layui-hide">
    <i class="layui-icon">&#xe602;</i>
  </div>
  <div class="site-mobile-shade"></div>
  <div class="fly-panel fly-panel-user" pad20>
      <div id="data"></div>
      <div id="page"></div>
  </div>
  

</div>

<div id="footer"></div>

<script>
  $("#header").load("../header.html");
  $("#footer").load("../footer.html");
</script>

<script src="../../res/layui/layui.js"></script>
<script>
  layui.use(['laypage','jquery','laytpl','element'], function(){
    var laypage = layui.laypage;
    var laytpl = layui.laytpl;
    var element = layui.element;
    $ = layui.jquery;
    var total = 0;
    var size = 5;


    function drawTpl(data,type) {
      console.log(data);
      var getTpl = list_tpl.innerHTML // list_tpl 模板
              ,view = document.getElementById("data");
      laytpl(getTpl).render(data, function(html){
        view.innerHTML = html;
      });
    }


    function showRecord(pageNo,pageSize,type,isFirst){
      $.ajax({
        //请求方式
        type : "POST",
        //请求地址
        url : path+'/inspect/list.do',
        //数据，json字符串
        data : {
          currentPage:pageNo,
          pageSize:pageSize,
          type:type,
          userId:1
        },
        datatype:"json",
        //请求成功
        success : function(res) {
          console.log(res);
          var list =res.data['pageInfo'];
          total =res.data.total;
          drawTpl(list,type);
          if (isFirst){
            SetPage(pageID,total);
          }
        },
        //请求失败，包含具体的错误信息
        error : function(res){

        }
      });
    };
    function SetPage(id,total) {
      laypage.render({
        elem: id
        , count: total
        , limit:5
        , curr: 1                        //起始页
        , groups: 5                      //连续页码个数
        , prev: '上一页'                 //上一页文本
        , next: '下一页'                 //下一页文本
        , first: 1                      //首页文本
        , limits: [5,10,15]
        , layout: ['prev', 'page', 'next','limit','refresh','skip']
        , jump: function (obj,first) {
          size = obj.limit;
          showRecord(obj.curr,obj.limit,0,false);
        }
      })
    }
    $.ajax({
      //请求方式
      type : "POST",
      //请求地址
      url : path+'/inspect/list.do',
      //数据，json字符串
      data : {
        currentPage:1,
        pageSize:5,
        type:0,
        userId:1
      },
      datatype:"json",
      //请求成功
      success : function(res) {
        console.log(res);
        pageInfo = res.data['pageInfo'];
        SetPage("page", pageInfo.total)
      }
    });




  })
</script>



<script id="list_tpl" type="text/html">
  <div class="layui-tab layui-tab-brief" lay-filter="user">
    <ul class="layui-tab-title" id="LAY_mine">
      <li data-type="mine-jie" lay-id="index" class="layui-this">我的举报（<span>{{ d.total }}</span>）</li>
    </ul>
    <div class="layui-tab-content" style="padding: 20px 0;">
      <div class="layui-tab-item layui-show">
        <ul>
          {{#  layui.each(d.list, function(index, item){ }}
            <li>
              <h2>
                <a class="layui-badge">{{ item.title}}</a>
                <a href="detail.html?id={{ item.id}}&type={{item.dataType}}">{{= item.title}}</a>
                {{#     if(item.process_status == 1){          }}
                | <span class="status_1">已提交</span>
                {{#     }else if(item.data.process_status == 2){    }}
                | <span class="status_2">已受理</span>
                {{#     }else{                              }}
                | <span class="status_3">已完结</span>
                {{#     } }}
              </h2>
              <div>
                <p>
                <h3 class="detail_text">

                </h3>
                </p>
                {{#s
                if (CheckIsNullOrEmpty(item.create_time)){
                var date = new Date();
                var createTime = item.data.create_time+"000";
                date.setTime(createTime);
                var t = date.Format("yyyy-MM-dd hh:mm:ss");
                }}
                <span class="time_text"> {{ t }}</span>
                {{#
                }else {
                }}
                <span class="time_text"> 无</span>
                {{# } }}

              </div>
            </li>
          {{# }) }}
        </ul>
      </div>
    </div>s
  </div>
 </script>
</body>
</html>

