

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>智慧检查</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../../../res/layui/css/layui.css">
    <link rel="stylesheet" href="../../../res/css/global.css">
    <script type="text/javascript" src="../../../res/layui/jquery.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../res/js/baseUtils.js" charset="utf-8"></script>
    <style type="text/css">
        .time_text{
            position:absolute;
            bottom:0px;
            padding:0px;
            margin:0px;
            color: #999;
        }
        .detail_text{
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 7;
            -webkit-box-orient: vertical;
            font-size: 15px;
        }
        .status_1{
            font-size: 5px; color: #2D93CA;text-align:center;line-height:15px;
        }
        .status_2{
            font-size: 5px; color: orange;text-align:center;line-height:15px;
        }
        .status_3{
            font-size: 5px; color: #FF5722;text-align:center;line-height:15px;
        }

    </style>
</head>
<body>
<div id="header"></div>

<div class="layui-container">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md8">
            <div class="fly-panel" style="margin-bottom: 0;">
                <div class="fly-panel-title fly-filter">
                    <a href="" class="layui-this">法律咨询</a>
                    <span class="fly-mid"></span>
                    <a href="">法律援助</a>
                    <span class="fly-mid"></span>
                    <a href="">司法救助</a>
                    <span class="fly-mid"></span>
                    <a href="/app/view/law/help/online-consultation-test.html">在线咨询</a>
                    <span class="fly-mid"></span>
                    <span class="fly-filter-right layui-hide-xs">
          </span>
                </div>

                <ul class="fly-list" id="data_ul">

                </ul>

                <!-- <div class="fly-none">没有相关数据</div> -->
                <div id="page"></div>
            </div>
        </div>
        <div class="layui-col-md4">
            <dl class="fly-panel fly-list-one">
                <!--        TODO 这周的新闻-->
                <dt class="fly-panel-title">本周新闻</dt>
                <dd>
                    <a href="">基于 layui 的极简社区页面模版</a>
                    <span><i class="iconfont icon-pinglun1"></i> 16</span>
                </dd>

                <!-- 无数据时 -->
                <!--
                <div class="fly-none">没有相关数据</div>
                -->
            </dl>

            <div class="fly-panel">
                <div class="fly-panel-title">
                    这里可作为广告区域
                </div>
                <div class="fly-panel-main">
                    <a href="" target="_blank" class="fly-zanzhu" style="background-color: #393D49;">虚席以待</a>
                </div>
            </div>

            <div class="fly-panel fly-link">
                <h3 class="fly-panel-title">友情链接</h3>
                <dl class="fly-panel-main">
                    <dd><a href="http://www.layui.com/" target="_blank">layui</a><dd>
                    <dd><a href="http://layim.layui.com/" target="_blank">WebIM</a><dd>
                    <dd><a href="http://layer.layui.com/" target="_blank">layer</a><dd>
                    <dd><a href="http://www.layui.com/laydate/" target="_blank">layDate</a><dd>
                    <dd><a href="mailto:xianxin@layui-inc.com?subject=%E7%94%B3%E8%AF%B7Fly%E7%A4%BE%E5%8C%BA%E5%8F%8B%E9%93%BE" class="fly-link">申请友链</a><dd>
                </dl>
            </div>

        </div>
    </div>
</div>

<div id="footer"></div>

<!-- 加载头部和尾部 -->
<script>
    $("#header").load("../../header.html");
    $("#footer").load("../../footer.html");
</script>

<script src="../../../res/layui/layui.js"></script>
<script>
    layui.cache.page = 'jie';
    layui.cache.user = {
        username: '游客'
        ,uid: -1
        ,avatar: '../../../res/images/avatar/00.jpg'
        ,experience: 83
        ,sex: '男'
    };
    layui.config({
        version: "3.0.0"
        ,base: '../../../res/mods/'
    }).extend({
        fly: 'index'
    }).use('fly');
</script>

<script>
    layui.use(['laypage','jquery','laytpl'], function(){
        var laypage = layui.laypage;
        var laytpl = layui.laytpl;
        $ = layui.jquery;
        var total = 0;
        function showRecord(pageNo,pageSize){
            $.ajax({
                //请求方式
                type : "POST",
                //请求地址
                url : path+'/inspect/inform/list.do',
                //数据，json字符串
                data : {
                    currentPage:pageNo,
                    pageSize:pageSize,
                },
                datatype:"json",
                //请求成功
                success : function(res) {
                    console.log(res);
                    var pageInfo =res.data['informs'];
                    total = pageInfo.total;
                    var adminMap =res.data['adminMap'];
                    var typeMap = res.data['typeMap'];
                    var list = pageInfo.list;
                    //console.log(adminMap);
                    var data = [];
                    for (var i in list){
                        var appeal = list[i];
                        var obj = {};
                        var admin= null,type= null,ad= null,ty= null;
                        admin = adminMap[appeal.id];
                        if (admin != null){
                            ad = {'adminName':admin.realname,'adminId':admin.id};
                        }
                        type = typeMap[appeal.id];
                        if (type != null){
                            ty = {'type':type['title']};
                        }
                        Object.assign(obj, appeal, ad,ty);
                        data.push(obj);
                    }
                    console.log(data);
                    var getTpl = list_tpl.innerHTML
                        ,view = document.getElementById('data_ul');
                    laytpl(getTpl).render(data, function(html){
                        view.innerHTML = html;
                    });
                },
                //请求失败，包含具体的错误信息
                error : function(res){

                }
            });
        };
        $.ajax({
            //请求方式
            type : "POST",
            //请求地址
            url : path+'/inspect/inform/list.do',
            //数据，json字符串
            data : {
                currentPage:1,
                pageSize:5,
            },
            datatype:"json",
            //请求成功
            success : function(res){
                pageInfo =res.data['informs'];
                laypage.render({
                    elem: 'page'
                    , count: pageInfo.total
                    ,limit:5
                    , curr: 1                        //起始页
                    , groups: 5                      //连续页码个数
                    , prev: '上一页'                 //上一页文本
                    , next: '下一页'                 //下一页文本
                    , first: 1                      //首页文本
                    ,limits: [5,10,15]
                    , layout: ['prev', 'page', 'next','limit','refresh','skip']
                    , jump: function (obj,first) {
                        showRecord(obj.curr,obj.limit);
                    }
            })}
        });
    });

</script>

<script id="list_tpl" type="text/html">

    {{#  layui.each(d, function(index, item){ }}
    <li style="height: 200px">
        <a href="user/home.html" class="fly-avatar">
            <img src="https://tva1.sinaimg.cn/crop.0.0.118.118.180/5db11ff4gw1e77d3nqrv8j203b03cweg.jpg" alt="贤心">
        </a>
        <h2>
            <a class="layui-badge">{{= item.type}}</a>
            <a href="detail.html">{{= item.title}}</a>
            {{#     if(item.process_status == 1){          }}
            <span>| </span><span class="status_1">已提交</span></td>
            {{#     }else if(item.process_status == 2){    }}
            <span>| </span><span class="status_2">已受理</span></td>
            {{#     }else{                              }}
            <span>| </span><span class="status_3">已完结</span></td>
            {{#     } }}
        </h2>
        <div>
            <a href="user/home.html" link>
<!--                <cite>{{= item.adminName}}</cite>-->
                <!--
                <i class="iconfont icon-renzheng" title="认证信息：XXX"></i>
                <i class="layui-badge fly-badge-vip">VIP3</i>
                -->
            </a>
            <p>
                <h3 class="detail_text">
                    {{ item.detail }}
                </h3>
            </p>
            {{#
            if (CheckIsNullOrEmpty(item.create_time)){
            var date = new Date();
            var createTime = item.create_time+"000";
            date.setTime(createTime);
            var t = date.Format("yyyy-MM-dd hh:mm:ss");
            }}
            <span class="time_text"> {{ t }}</span>
            {{#
            }else {
            }}
            <span class="time_text"> 无</span>
            {{# } }}


<!--            <span class="fly-list-kiss layui-hide-xs" title="悬赏飞吻"><i class="iconfont icon-kiss"></i> 60</span>-->
<!--            &lt;!&ndash;<span class="layui-badge fly-badge-accept layui-hide-xs">已结</span>&ndash;&gt;-->
<!--            <span class="fly-list-nums">-->
<!--                <i class="iconfont icon-pinglun1" title="回答"></i> 66-->
<!--              </span>-->
        </div>
<!--        <div class="fly-list-badge">-->
<!--            &lt;!&ndash;<span class="layui-badge layui-bg-red">精帖</span>&ndash;&gt;-->
<!--        </div>-->
    </li>
    {{#  }); }}
</script>
</body>
</html>